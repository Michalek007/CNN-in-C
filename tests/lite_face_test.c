//
// Created by Micha≈Ç on 02.01.2025.
//
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "lite_face_test.h"
#include "cnn_test.h"
#include "lite_face.h"
#include "lite_face_test_data.h"

void LiteFaceTest_Model0(){
    float output[128];
    LiteFace_Model(3, 100, 100, LiteFaceTest_input0, output);
    float expectedOutput[] = {0.01316, 0.0118, -0.13351, -0.00105, 0.10253, 0.10169, -0.12063, -0.02631, 0.04716, 0.00188, 0.13201, -0.0659, -0.00518, 0.07692, -0.11141, -0.00072, 0.17534, 0.07654, -0.06844, -0.02554, -0.1068, 0.02367, 0.1049, -0.08028, 0.04724, 0.12425, 0.07336, -0.03982, 0.12406, 0.09262, -0.08818, -0.0304, -0.03263, -0.01511, 0.04676, 0.05921, -0.23701, -0.16476, -0.0056, 0.01072, 0.12832, 0.09249, -0.08566, -0.0046, 0.06762, -0.01918, -0.09976, -0.08492, 0.11341, 0.03623, -0.13816, 0.10384, 0.04245, -0.03962, 0.14979, 0.07639, -0.02809, -0.01544, 0.10052, -0.01435, -0.00605, -0.08453, 0.07733, 0.02874, 0.02531, -0.02076, -0.02431, 0.13179, -0.04644, -0.07034, 0.03634, 0.02492, 0.12604, 0.17462, 0.08181, -0.05332, 0.18512, -0.02276, 0.12204, -0.03552, 0.09361, 0.05475, -0.00221, -0.07352, 0.1474, 0.14874, -0.00589, -0.00629, -0.04076, 0.01362, 0.00244, 0.00211, 0.17141, -0.1273, 0.17098, -0.10077, 0.04816, 0.02753, -0.03174, 0.14075, -0.0482, 0.07034, 0.06548, 0.05386, 0.09851, 0.13016, -0.00034, -0.06682, -0.11045, 0.09043, 0.00198, -0.06348, 0.10712, 0.01363, 0.13564, 0.05684, -0.08907, -0.08048, 0.04907, -0.10169, 0.08398, -0.05439, 0.01407, -0.05614, -0.08165, 0.18445, -0.17413, -0.08514};
    for (size_t i=0;i<128;++i){
        printf("Output [%d]: %f\n", i, output[i]);
        assert(equalFloatDefault(output[i], expectedOutput[i]));
    }
}